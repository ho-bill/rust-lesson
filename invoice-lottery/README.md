# 台灣統一發票模擬器

* 來由: 某次對完發票後，覺得自己太"非"，所以開發此模擬器來測試自己的運氣值。
* 程式會模擬有100 人，每個人有100張發票來進行對獎，最後列出中獎總額。
* 每次實驗發票都由第一張號碼開始，下一張都會增加一個2~9999亂數號碼

## 執行方式: 直接使用 `cargo eun` 執行即可
* 使用預設值參數執行結果如下

```
Hello, 統一發票模擬器
讀取環境變數 THREAD_NUM 不存在, 改用預設值 : 2
讀取環境變數 INT_NUMBER 不存在, 改用預設值 : 10000000
讀取環境變數 USER_NUMBER 不存在, 改用預設值 : 100
讀取環境變數 TICKETS_NUM 不存在, 改用預設值 : 100
執行緒0 : 由10000000 開始對發票，共100人，每人100張，開始
執行緒1 : 由10000000 開始對發票，共100人，每人100張，開始
Lucky user,002#0, Voice num, 10886900, win, 200
....
....
Lucky user,100#0, Voice num, 59643404, win, 200
Lucky user,100#1, Voice num, 59824128, win, 200
##執行緒 0 完畢##
##執行緒 1 完畢##
Time spent : 51.1s

======== 測試第 1 次結果如下 ========
本次模擬 100 人, 每人對獎100張
發票獎金200 : 有30張
發票獎金1000 : 有4張
本次有30中獎人
總獎金10000元
最大獎1000元
沒中獎發票9966張

======== 測試第 2 次結果如下 ========
本次模擬 100 人, 每人對獎100張
發票獎金200 : 有24張
發票獎金1000 : 有1張
本次有23中獎人
總獎金5800元
最大獎1000元
沒中獎發票9975張
``` 
### 參數設定
* 執行前，可以設定shell 的環境變數就可以讓程式讀取執行
* 程式開始時可以看到目前參數的狀況
* THREAD_NUM : 設定多執行緒，同時進行多組模擬，讓CPU更溫暖。預設為2 ; 接受值 1~64
* INT_NUMBER : 第一張發票號碼，可以設為你手上任一張發票號碼。預設10000000 ; 接受值 1~99999999
* USER_NUMBER : 設定實驗人數。預設為100 ; 接受值 1~1000000
* TICKETS_NUM : 設定(每個人)擁有的發票數。預設100; 接受值 1~1000000

### 最後結果 
* 顯示如下
```
======== 測試第 1 次結果如下 ========
本次模擬 100 人, 每人對獎100張
發票獎金200 : 有30張
發票獎金1000 : 有4張
本次有30中獎人
總獎金10000元
最大獎1000元
沒中獎發票9966張
```
## 程式結構
* 資料夾如下 src/ 只有main.rs 。其餘程式都在lottery_chk之中
* main.rs : 主程式。會開啟多個執行緒，每個執行緒都有 100人對獎100張發票，只有中獎發票才會顯示。
* drawing.ts : 定義開獎號碼，例如2023/01 月開獎的號碼定義在此。drawingresult 寫入所有的中獎號與獎金
* checker.rs : check_winning 可以比對發票數字與上面的中獎號來得到獎金
* envreader.rs : 讀取並檢查環境變數
* mod.rs : 設定模組的檔案

```
├── Cargo.lock
├── Cargo.toml
├── README.md
├── lottery_chk
│   ├── Cargo.toml
│   └── src
│       ├── lib.rs
│       └── lottery
│           ├── checker.rs
│           ├── drawing.rs
│           ├── envreader.rs
│           └── mod.rs
└── src
    └── main.rs
```